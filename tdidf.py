import pandas as pd
import pefile
import os 
from sklearn.feature_extraction.text import TfidfVectorizer

all_executable_apis = []
IDFs = {}

def extractImports(document):
	samples = os.listdir(filepath)
	for sample in samples:
		executablePath = filepath + '/' + sample
		executable = pefile.PE(executablePath)
		for IMAGE_IMPORT_DESCRIPTOR in executable.DIRECTORY_ENTRY_IMPORT:
			for function in IMAGE_IMPORT_DESCRIPTOR.imports:
				try:
					document.add(function.name.decode())
				except AttributeError:
					continue

def main():
	global all_executable_apis
	os.listdir('/home/student/Downloads/Benign')
	for sample in samples:
		extractImports(all_executable_apis)
	all_executable_apis.sort()
	for sameple in samples:
		current_executable_apis = []
		extractImports(current_executable_apis)
		for apiCall in current_executable_apis:
			if apiCall in IDFS:
				continue
			else:
				count = 0
				for call in all_executable_apis:
					if apiCall == call:
						count += 1
				IDFs.update({apiCall: count})
	print(IDFs)


if __name__ == '__main__':
	main()