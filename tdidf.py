import pefile
import os 

filepath = '/home/student/Downloads/Malware'

def importsFromAllExecutables(sample):
	global filepath
	currentCorpus = []
	executablePath = filepath + '/' + sample
	executable = pefile.PE(executablePath)
	for IMAGE_IMPORT_DESCRIPTOR in executable.DIRECTORY_ENTRY_IMPORT:
		for function in IMAGE_IMPORT_DESCRIPTOR.imports:
			try:
				print(function.name.decode())
				currentCorpus.add(function.name.decode())
			except:
				continue
	return currentCorpus

def main():
	global filepath
	samples = os.listdir(filepath)
	for sample in samples:
		currentCorpus = extractImports(sample)
		print(currentCorpus)


if __name__ == '__main__':
	main()
