import pefile
import os 

BENIGN_EXECUTABLES = '/home/student/Downloads/Benign'
MALICIOUS_EXECUTABLES = '/home/student/Downloads/Malware'

#REMEMBER TODO DELETE ALL NON EXE Benign FILES
def importsFromAllExecutables(filepath):
	samples = os.listdir(filepath)
	for sample in samples:
		executablePath = filepath + '/' + sample
		executable = pefile.PE(executablePath)
		try:
			for IMAGE_IMPORT_DESCRIPTOR in executable.DIRECTORY_ENTRY_IMPORT:
				for function in IMAGE_IMPORT_DESCRIPTOR.imports:
					print(function.name.decode())
		except AttributeError:
			print('[+] No Recognizable Import Address Table')

def main():
	importsFromAllExecutables(MALICIOUS_EXECUTABLES)
	importsFromAllExecutables(BENIGN_EXECUTABLES)
	


if __name__ == '__main__':
	main()
